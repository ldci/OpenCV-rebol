#! /usr/bin/rebolREBOL [	Title:		"OpenCV Tests: HSV and MAsk "	Author:		"François Jouen"	Rights:		"Copyright (c) 2012-2014 François Jouen. All rights reserved."	License:    "BSD-3 - https://github.com/dockimbel/Red/blob/master/BSD-3-License.txt"]do %../opencv.rset 'appDir what-dir ;picture:  to-string to-local-file join appDir "images/lena.tiff"print "Select a picture"temp: request-file picture: to-string to-local-file to-string tempwName1: "Image 1 [ESC to Quit]"wName2: "HSV "wName3: "Mask" src: cvLoadImage picture CV_LOAD_IMAGE_COLOR; CV_LOAD_IMAGE_GRAYSCALE; &src: as-pointer! src; creates HSV image&hsv: as-pointer! cvCloneImage &src; conversion BGR to HSV cvCvtColor &src &hsv CV_BGR2HSV; creates mask: same size as original but only 1 channel&mask: as-pointer! cvCreateImage src/width src/height src/depth 1;cvZero &maskv: cvScalar 255 255 255 255cvAddS &mask v/v0 v/v1 v/v2 v/v3 &mask nonel: cvScalar 128 128 128 128u: cvScalar 255 255 255 255cvInRangeS &hsv l/v0 l/v1 l/v2 l/v3 u/v0 u/v1 u/v2 u/v3 &maskcvNamedWindow wName1 CV_WINDOW_AUTOSIZE cvNamedWindow wName2 CV_WINDOW_AUTOSIZEcvNamedWindow wName3 CV_WINDOW_AUTOSIZEcvShowImage wName1 &src cvShowImage wName2 &hsv cvShowImage wName3 &mask cvMoveWindow wName1  100 100cvMoveWindow wName2  140 200cvMoveWindow wName3  180 300cvWaitKey 0cvWaitKey 0print "Hit a key!"cvDestroyAllWindows ; release image pointercvReleaseImage src cvReleaseImage &src cvReleaseImage &hsvcvReleaseImage &mask